"use strict";var express=require("express"),path=require("path"),sqlite3=require("sqlite3").verbose(),data=require("./data.json"),_require=require("./mongodb"),setupDB=_require.setupDB,findHighestPing=_require.findHighestPing,wrap=require("./wraper"),pino=require("pino"),expressPino=require("express-pino-logger"),logger=pino({level:process.env.LOG_LEVEL||"info"}),app=express(),port=process.env.PORT||"8000";app.set("views",path.join(__dirname,"views")),app.set("view engine","pug"),app.use(express.static(path.join(__dirname,"public")));var _require2=require("mongodb"),MongoClient=_require2.MongoClient,_require3=require("../config.json"),password=_require3.password,uri=_require3.uri,client=new MongoClient(uri,{useNewUrlParser:!0,useUnifiedTopology:!0});app.get("/",function(r,n){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:logger.debug("".concat(r.ip," sent GET to /}")),n.render("ping-project/index",{title:"Home"});case 2:case"end":return e.stop()}})}),app.get("/ping",wrap(function(r,n){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return logger.debug("".concat(r.ip," sent GET to /ping}")),e.next=3,regeneratorRuntime.awrap(client.connect());case 3:return cursor=client.db("ping").collection("ping").find({}).sort({_id:-1}),e.next=6,regeneratorRuntime.awrap(cursor.toArray());case 6:row=e.sent,console.log(row),n.render("ping-project/ping",{title:"ping project",data:row});case 9:case"end":return e.stop()}})})),app.get("/high-ping",wrap(function(e,r){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(client.connect());case 2:return cursor=client.db("ping").collection("ping").find({ping_value:{$gt:500}}),e.next=5,regeneratorRuntime.awrap(cursor.toArray());case 5:row=e.sent,console.log(row),r.render("ping-project/ping-high",{title:"High Ping",userProfile:{data:row}});case 8:case"end":return e.stop()}})})),app.get("/low-ping",wrap(function(e,r){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(client.connect());case 2:return cursor=client.db("ping").collection("ping").find({ping_value:{$lt:45}}),e.next=5,regeneratorRuntime.awrap(cursor.toArray());case 5:row=e.sent,console.log(row),r.render("ping-project/ping-low",{title:"Low Ping",userProfile:{data:row}});case 8:case"end":return e.stop()}})})),app.get("/development",function(e,r){r.render("ping-project/development",{title:"development",data:data})}),app.listen(port,function(){console.log("Listening for requests on http://localhost:".concat(port))});